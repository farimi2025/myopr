<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OPR Sekolah ‚Äì Laporan Mesyuarat & Aktiviti (One Page)</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="icon-192.png" type="image/png" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
<div id="app" class="app-container">

    <header>
        <h1>Laporan Sekolah Satu Muka (OPR)</h1>
        <p class="sokongan">
            Aplikasi untuk semua guru, PK dan Guru Besar ‚Äì isi laporan, ambil gambar, cetak & simpan PDF. Boleh digunakan walaupun offline.
        </p>
    </header>

    <!-- Butang untuk edit maklumat sekolah & guru -->
    <button id="editDataSekolahBtn" style="display:none; margin-bottom:16px;">
        ‚úèÔ∏è Edit Maklumat Sekolah & Guru
    </button>

    <!-- Borang Maklumat Sekolah & Guru -->
    <section id="dataSekolah" class="kad-borang" style="display:none;">
        <h2>Maklumat Sekolah & Guru</h2>
        <form id="formSekolah" autocomplete="off">
            <label>
                Nama Sekolah:
                <input type="text" id="namaSekolah" required placeholder="Contoh: SK Sokor" />
            </label>
            <label>
                Alamat Sekolah:
                <textarea id="alamatSekolah" rows="2" placeholder="Alamat penuh sekolah"></textarea>
            </label>
            <label>
                Logo Sekolah (PNG/JPG):
                <input type="file" id="logoSekolah" accept="image/png, image/jpeg" />
            </label>
            <div id="previewLogo"></div>
            <label>
                Nama Guru Pelapor:
                <input type="text" id="guruPelapor" required placeholder="Nama penuh guru pelapor" />
            </label>
            <label>
                Nama Penolong Kanan:
                <input type="text" id="guruPenyemak" placeholder="Nama penuh Penolong Kanan" />
            </label>
            <label>
                Nama Guru Besar:
                <input type="text" id="guruPengesah" placeholder="Nama penuh Guru Besar" />
            </label>
            <button type="submit" class="btn-utama">Simpan Maklumat Sekolah & Guru</button>
        </form>
    </section>

    <!-- Borang Laporan OPR -->
    <section id="borangOPR" class="kad-borang">
        <h2>Borang Laporan / Mesyuarat / Aktiviti Sekolah</h2>
        <form id="oprForm" autocomplete="off">

            <label>
                Nama Program/Aktiviti:
                <input type="text" id="namaProgram" required placeholder="Contoh: Mesyuarat Guru, Sukan Tahunan" />
            </label>
            <label>
                Tarikh & Masa:
                <input type="datetime-local" id="tarikhMasa" required />
            </label>
            <label>
                Tempat:
                <input type="text" id="tempat" required placeholder="Contoh: Dewan Terbuka" />
            </label>
            <label>
                Anjuran:
                <input type="text" id="anjuran" placeholder="Contoh: Sekolah, PPD, JPN, KPM, Persatuan" />
            </label>
            <label>
                Sponsor / Penaja:
                <input type="text" id="penaja" placeholder="Contoh: PIBG, Bank Rakyat, YB Parlimen" />
            </label>
            <label>
                Sasaran:
                <input type="text" id="sasaran" placeholder="Contoh: Semua Guru, Semua Murid Tahun 6" />
            </label>
            <label>
                Objektif:
                <textarea id="objektif" rows="2" placeholder="Nyatakan objektif program/mesyuarat..."></textarea>
            </label>
            <label>
                Butiran Aktiviti:
                <textarea id="butiranAktiviti" rows="3" placeholder="Ulasan/aturcara utama..."></textarea>
            </label>
            <label>
                Pencapaian:
                <textarea id="pencapaian" rows="2"></textarea>
            </label>
            <label>
                Kekuatan:
                <textarea id="kekuatan" rows="2"></textarea>
            </label>
            <label>
                Kelemahan:
                <textarea id="kelemahan" rows="2"></textarea>
            </label>
            <label>
                Cadangan Intervensi:
                <textarea id="intervensi" rows="2"></textarea>
            </label>
            <label>
                Impak Program:
                <textarea id="impak" rows="2"></textarea>
            </label>
            <label>
                Kos, Peralatan/Bahan:
                <textarea id="kos" rows="1" placeholder="Contoh: RM300, P.A System, Kertas"></textarea>
            </label>

            <label>
                Nama Penyedia: <span class="nota">(Guru Pelapor)</span>
                <input type="text" id="penyedia" readonly />
            </label>
            <label>
                Nama Penyemak: <span class="nota">(Penolong Kanan)</span>
                <input type="text" id="penyemak" readonly />
            </label>
            <label>
                Nama Pengesah: <span class="nota">(Guru Besar)</span>
                <input type="text" id="pengesah" readonly />
            </label>

            <!-- Gambar Bukti -->
            <label>
                Gambar Bukti (pilihan):
                <div class="grup-gambar">
                    <button type="button" id="ambilGambarBtn">üì∑ Ambil Gambar</button>
                    <button type="button" id="uploadGambarBtn">üñºÔ∏è Upload Gambar</button>
                    <input
                        type="file"
                        id="gambarBukti"
                        accept="image/*"
                        capture="environment"
                        multiple
                        style="display:none"
                    />
                    <button type="button" id="padamGambarBtn" style="display:none">‚ùå Padam Gambar</button>
                </div>
                <span id="statusKamera" style="display:block;color:#c11;font-size:0.97em;"></span>
            </label>

            <div class="gambar-preview" id="gambarPreview"></div>

        </form>

        <div class="butang-grup" style="margin-top:15px;">
            <button id="simpanBtn" type="button">Simpan Laporan</button>
            <button id="importBtn" type="button">Import Data</button>
            <input type="file" id="importFile" accept=".json" style="display:none" />

            <button id="downloadBtn" type="button">Download Data (JSON)</button>
            <button id="cetakBtn" type="button">Preview Cetak</button>
            <button id="downloadPdfBtn" type="button">Download Laporan Ini (PDF)</button>
        </div>
    </section>

    <!-- Senarai & Carian -->
    <section id="senaraiLaporan" class="kad-senarai">
        <h2>Senarai Laporan</h2>
        <input
            type="search"
            id="carianInput"
            placeholder="Cari laporan / program / tempat..."
            aria-label="Cari laporan"
        />
        <div id="listOPR"></div>
    </section>
</div>

<footer>
    <p>Hakcipta GB Mie &copy; 2025. Dikod dengan penuh kasih sayang dan hormat kepada cikgu-cikgu SK Sokor.</p>
    <p>
        <a href="https://github.com/farimi2025/myopr" target="_blank" rel="noopener noreferrer"
            >Kod Sumber (GitHub)</a
        >
    </p>
</footer>

<script src="app.js"></script>
<script>
    // Daftar service worker
    if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("service-worker.js");
    }
</script>
</body>
</html>
